---
title: "Simulation"
author: "Yunyang Zhong, Katherin Li, Linfeng Hu"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Generation

#### Maximum Likelihood Solution
$$
\begin{align}
& L(X_1...X_n) = \sum_{i=1}^{n} exp(-\lambda) \frac{\lambda^{X_i}}{X_i!}\\
& l(X_1...X_n) = log(L(X_1...X_n)) = -n\lambda - \sum_{i=1}^{n}log(X_i!)+log(\lambda)\sum_{i=1}^{n}X_i \\
& \frac{dl}{d\lambda} = -n + \frac{\sum_{i=1}^{n}X_i}{\lambda} \quad \longrightarrow \quad \hat{\lambda}_{MLE} = \frac{\sum_{i=1}^{n}X_i}{n}
\end{align}
$$

```{r}
set.seed(222)
x_sim <- rpois(10, 327)
x_MLE <- sum(x_sim)/10
x_MLE
```


#### Bootstrap
```{r, warning=FALSE}
x_boot <-sample(x_sim, size=10, replace = T)
mean(x_boot)
```






#### Method of Moment Solution
Using second method to estimate $\hat \lambda$.
$$
\begin{align}
& E[X^2] = Var(X) + E[X^2] = \lambda+\lambda^2 \\
& 2nd\;sample\;moment = \frac{\sum_{i=1}^{n}X_i^2}{n}\\
\end{align}
$$

```{r}
sum(x_sim^2)/10
```




